Sub StockAnalysis():

    ' Setting intial variables
    Dim i As Integer
    Dim j As Integer
    Dim firstOpen As Double
    Dim lastClose As Double
    Dim yearlyChange As Double
    Dim percentChange As Double
    Dim totalVolume As Double
        
    j = 1
    totalVolume = 0
    
    ' Gather data for summary table
    For i = 2 To 526
        
       ' Record initial opening price on new worksheets
       If i = 2 Then
            firstOpen = Cells(i, 3).Value
       End If
                    
       If Cells(i + 1, 1).Value = Cells(i, 1).Value Then
            totalVolume = totalVolume + Cells(i, 7).Value
       Else
            totalVolume = totalVolume + Cells(i, 7).Value
            lastClose = Cells(i, 6).Value
            
            ' Change calculations
            yearlyChange = lastClose - firstOpen
            percentChange = 100 * (yearlyChange / firstOpen)
            
            ' Add summary table header when working with multiple worksheets
            If j = 1 Then
                Cells(j, 9).Value = "Ticker"
                Cells(j, 10).Value = "Yearly Change"
                Cells(j, 11).Value = "Percent Change"
                Cells(j, 12).Value = "Total Stock Volume"
            End If
            
            ' Post data to summary table
            j = j + 1
            Cells(j, 9).Value = Cells(i, 1).Value ' ticker
            Cells(j, 10).Value = yearlyChange
            Cells(j, 11).Value = percentChange
            Cells(j, 12).Value = totalVolume
            
            ' Value resets
            firstOpen = Cells(i + 1, 3).Value
            totalVolume = 0
       End If
    
    Next i

End Sub
